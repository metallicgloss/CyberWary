{% extends "portal.html" %}

{% load static %}

{% comment %}
GNU General Public License v3.0
Cyber Wary - <https://github.com/metallicgloss/CyberWary>
Copyright (C) 2021 - William P - <hello@metallicgloss.com>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
{% endcomment %}

{% block page_content %}
    <div class="row py-5">
        <div class="col-lg-12 col-xl-12">
            <button class="btn back-btn p-0 mb-3" onclick="history.back()"><i class="icofont-arrow-left"></i> Back</button>
            <h2 class="mb-0"><span id="scan-title">{{ scan_record.scan.title }}</span></h2>
            <div class="d-flex align-items-start scan-brief">
                <p class="me-3 mb-3">{% now "l jS F Y" %}</p>
                <svg width="3" height="3" viewBox="0 0 3 3" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="3" height="3" fill="#34CC96" />
                </svg>
                <p class="ms-3 mb-3"><span id="scan-type" class="{% if scan_record.scan.type == "B" %}text-info{% else %}text-danger-alt{% endif %}">{% if scan_record.scan.type == "B" %}Blue{% else %}Red{% endif %} Team</span> Scan</p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12 col-xl-9">
            <div class="scan-report-container">
                <div class="scan-report pe-4">
                    Overview
                    
                    <div id="map"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 col-xl-3">
            <div class="scan-info ps-4">
                <h5>Scan Record Information</h5>
                <p class="mb-2">Scan Initialisation: <span>{{ scan_record.created|date:"d/m/Y H:i" }}</span></p>

                <h5 class="mt-4">Device Information</h5>
                <p class="mb-1">Device Name: <span>{{ scan_record.name }}</span></p>
                <p class="mb-1">Registered Owner: <span>{{ scan_record.os_install.owner }}</span></p>
                <p class="mb-1">Active User: <span>{{ scan_record.current_user }}</span></p>
                <p class="mb-1">Public IP Address: <span>{{ scan_record.public_ip }}</span></p>
            </div>
        </div>
    </div>
{% endblock %}


{% block page_scripts %}
<script async src="https://maps.googleapis.com/maps/api/js?key={{ maps_key }}&callback=initMap"></script>
<script>
    function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 9,
            center: {
                lat: 51.5072,
                lng: 0.1276
            },
            disableDefaultUI: true,
            styles: [
            {
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#1d1c28"
                }
              ]
            },
            {
              "elementType": "labels.icon",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "elementType": "labels.text.stroke",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "administrative",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#e9e9e9"
                }
              ]
            },
            {
              "featureType": "landscape.natural",
              "elementType": "labels",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "poi",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "road",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#2e2d40"
                }
              ]
            },
            {
              "featureType": "road",
              "elementType": "labels",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "road",
              "elementType": "labels.icon",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "transit",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "water",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#3a3850"
                }
              ]
            },
            {
              "featureType": "water",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#ffffff"
                }
              ]
            }
          ],
        });
      
        new google.maps.Marker({
            position: {
                lat: 51.5072,
                lng: 0.1276
            },
            map,
            icon: "{% static 'imgs/map.png' %}",
            title: "{{ scan_record.name }}",
        });
      }
</script>
{% endblock %}