<p align="center">
    <img src="https://www.cyberwary.com/static/imgs/logo.jpg" alt="Logo" width="230" height="54" />
</p>
<h1 align="center" style="margin-bottom:-15px;">Final Year Project</h1>
<p align="center" style="font-weight: bold">A SaaS Solution to Detect Threats and Vulnerabilities Recurrent in the Windows Home Ecosystem.</p>

<p align="center">
    <img alt="GitHub Languages" src="https://img.shields.io/github/languages/count/metallicgloss/CyberWary?style=for-the-badge">
    <img alt="GitHub Lines of Code" src="https://img.shields.io/tokei/lines/github/metallicgloss/CyberWary?style=for-the-badge">
    <img alt="Travis" src="https://img.shields.io/travis/com/metallicgloss/CyberWary?style=for-the-badge">
    <img alt="GitHub Top Language" src="https://img.shields.io/github/languages/top/metallicgloss/CyberWary?style=for-the-badge">
    <img alt="GitHub Repo Size" src="https://img.shields.io/github/repo-size/metallicgloss/CyberWary?style=for-the-badge">
    <br>
    <a href="https://cyberwary.com">
        <img alt="CyberWary Site" src="https://img.shields.io/badge/CyberWary-Website-34cc96?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTEuOTg4IiBoZWlnaHQ9IjE5MiIgZmlsbD0id2hpdGUiLz4KPG1hc2sgaWQ9Im1hc2swXzY2MV8xOCIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjE5MiIgaGVpZ2h0PSIxOTIiPgo8cmVjdCB3aWR0aD0iMTkxLjk4OCIgaGVpZ2h0PSIxOTIiIGZpbGw9IndoaXRlIi8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NjFfMTgpIj4KPHJlY3QgeT0iNjQuMDA2IiB3aWR0aD0iODI0LjgzNiIgaGVpZ2h0PSIyMS4zMzMzIiBmaWxsPSIjMUQxQzI4Ii8+CjxyZWN0IHk9Ijk5LjU0ODEiIHdpZHRoPSI4MjQuODM2IiBoZWlnaHQ9IjIxLjMzMzMiIGZpbGw9IiMxRDFDMjgiLz4KPC9nPgo8L3N2Zz4K">
    </a>
    <a href="https://www.metallicgloss.com">
        <img alt="Personal Profile" src="https://img.shields.io/badge/MetallicGloss-Website-A367DF?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMi43MiAzNy43OCI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiNiN2I3Yjc7fS5jbHMtMntmaWxsOiNlNGU0ZTQ7fS5jbHMtM3tmaWxsOiNjOWM5Yzk7fS5jbHMtNHtmaWxsOiNmZmY7fTwvc3R5bGU+PC9kZWZzPjxnIGlkPSJMYXllcl8yIiBkYXRhLW5hbWU9IkxheWVyIDIiPjxnIGlkPSJMYXllcl8xLTIiIGRhdGEtbmFtZT0iTGF5ZXIgMSI+PHBvbHlnb24gY2xhc3M9ImNscy0xIiBwb2ludHM9IjIxLjgxIDE4Ljg5IDE2LjM2IDI4LjM0IDIxLjgxIDM3Ljc4IDI3LjI3IDI4LjM0IDI3LjI3IDI4LjM0IDMyLjcyIDE4Ljg5IDIxLjgxIDE4Ljg5Ii8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjEwLjkxIDAgNS40NSA5LjQ1IDUuNDUgOS40NSA1LjQ1IDkuNDUgMCAxOC44OSAxMC45MSAxOC44OSAxNi4zNiA5LjQ1IDEwLjkxIDAiLz48cG9seWdvbiBjbGFzcz0iY2xzLTMiIHBvaW50cz0iMTAuOTEgMTguODkgMCAxOC44OSA1LjQ1IDI4LjM0IDEwLjkxIDM3Ljc4IDE2LjM2IDI4LjM0IDIxLjgxIDE4Ljg5IDEwLjkxIDE4Ljg5Ii8+PHBvbHlnb24gY2xhc3M9ImNscy00IiBwb2ludHM9IjIxLjgxIDE4Ljg5IDMyLjcyIDE4Ljg5IDI3LjI3IDkuNDUgMjEuODEgMCAxNi4zNiA5LjQ1IDEwLjkxIDE4Ljg5IDIxLjgxIDE4Ljg5Ii8+PC9nPjwvZz48L3N2Zz4=">
    </a>
</p>
<h2></h2>
<br>
<p align="center">
    <b>Please Note</b>
    <br>
    This application has been produced as part of an academic research project undertaken at the University of Greenwich, and as such, its codebase should <b>not</b> be considered as production ready.
</p>
<h2></h2>
<br>
<h2>CyberWary Project Overview</h2>
<p>
    The project that this application is associated with explores the inherent risks surrounding the executable-based architecture that forms the foundation of the Windows platform, and the subsequent identification of methods aimed toward the advancement of security awareness for its users. Centred on the research of recurrent threats that it is frequently subjected to, this project encompasses developing a proposed solution utilising a Software as a Service approach to convey critical information associated with users' devices. This repository contains a successfully fabricated product to aid navigate the complexities of software vulnerability identification, browser password storage insecurities and data handling intricacies to deliver a prototype capable of achieving all defined objectives.
</p>
<br>
<h2>Getting Started</h2>
<p>
    Just a reminder, this application forms part of a research project, so use in the real-world is not recommended! The following instructions are for the installation and configuration of an instance of the CyberWary platform; they are not the steps for running a scan using the platform!
</p>

<h3>Self-Setup and Installation</h3>
<p>
    <b>Minimum Python Requirement (As Tested)</b>
    <ul>
        <li>Python 3.10.4</li>
        <li>PIP 22.0.4</li>
    </ul>
</p>
<br>
<p>
    <b>Compatible Operating Systems (As Tested)</b>
    <ul>
        <li>Windows 10 Home (Version 21H2)</li>
        <li>Windows 10 Pro (Version 21H2)</li>
        <li>Windows 11 Home (Version 21H2)</li>
        <li>Windows 11 Pro (Version 21H2)</li>
        <li>CloudLinux 8</li>
    </ul>
</p>
<br>
<p>
    <b>Software Setup & Installation Steps</b>
    <ol>
        <li>This project uses multiple packages from the Python Package Index (PyPI) repository; get these installed first.</li>
        <ol type="i">
            <li>Please execute <code>pip install -r requirements.txt</code> to install PIP requirements.</li>
        </ol>
        <li>Rename the file <code>.env.template</code> in your project directory to <code>.env</code>.</li>
        <li>Connect your installation of the CyberWary platform to a database.</li>
        <ol type="i">
            <li>If you don't already have one, setup a MySQL database now and get the credentials available.</li>
            <li>Populate the environment variables contained within your <code>.env</code> file - the ones you're looking for are <code>CYBERWARY_MYSQL_DB</code>, <code>CYBERWARY_MYSQL_USER</code>, <code>CYBERWARY_MYSQL_PASSWORD</code>, <code>CYBERWARY_MYSQL_HOST</code>, <code>CYBERWARY_MYSQL_PORT</code>.</li>
        </ol>
        <li>Create a secure secret key for your Django installation to use.</li>
        <ol type="i">
            <li>Generate a random secure string (64 chars, upper & lowercase chars, numbers and symbols recommended) and populate the <code>CYBERWARY_SECRET</code> variable in the <code>.env</code> file.</li>
        </ol>
        <li>Generate your database structure.</li>
        <ol type="i">
            <li>Execute the command <code>python manage.py migrate</code>.</li>
        </ol>
        <li>In a new terminal instance (or in a screen instance - recommended), import common enumeration data.</li>
        <ol type="i">
            <li>See the <a href="#automated-data-import"><u>Automated Data Import</u></a> section for further details.</li>
        </ol>
        <li>Generate a Send Mail API key from SendGrid (or replace mail sending mechanism).</li>
        <ol type="i">
            <li>See the <a href="https://docs.sendgrid.com/ui/account-and-settings/api-keys"><u>SendGrid API</u></a> page to create a key</li>
            <li>Populate the <code>CYBERWARY_SENDGRID_API_KEY</code> variable in your <code>.env</code> file.</li>
            <li>Update the <code>CYBERWARY_SENDGRID_EMAIL</code> variable with an email address from a domain authenticated through your SendGrid account.</li>
        </ol>
        <li>Populate your site information for easy viewing.</li>
        <ol type="i">
            <li>Populate the remaining variables in your <code>.env</code> file to update various elements of the site; please be sure to remove or replace the contents of <code>cyber_wary_site/templates/pp.html</code> and <code>cyber_wary_site/templates/tos.html</code>.</li>
        </ol>
        <li><b>(Optional)</b> Download a copy of the GeoLite2 database.</li>
        <ol type="i">
            <li>See the <a href="https://dev.maxmind.com/geoip/geolite2-free-geolocation-data"><u>MaxMind GeoLite2</u></a> page to download a copy of the country and city databases.</li>
            <li>Populate the <code>CYBERWARY_GEOIP_DIRECTORY</code> variable in your <code>.env</code> file to point to the directory where you extract them.</li>
        </ol>
        <li><b>(Optional)</b> Configure Google Javascript Maps API for map rendering.</li>
        <ol type="i">
            <li>See the <a href="https://developers.google.com/maps/documentation/javascript/cloud-setup"><u>Google Maps Platform API</u></a> page to enable your Google Maps JavaScript API, and obtain a copy of your key.</li>
            <li>Populate the <code>CYBERWARY_GOOGLE_MAPS_API_KEY</code> variable in your <code>.env</code> file with your key.</li>
        </ol>
        <li><b>(Optional)</b> Enable Google OAuth2.</li>
        <ol type="i">
            <li>See the <a href="https://developers.google.com/identity/protocols/oauth2"><u>Google OAuth 2.0 API</u></a> page to create an application.</li>
            <li>Populate the <code>CYBERWARY_GOOGLE_CLIENT_ID</code> and <code>CYBERWARY_GOOGLE_SECRET</code> variables in your <code>.env</code> file.</li>
            <li>When requested, enter the callback URL as <code>{your_url_here}/portal/account/google/login/callback/</code>.</li>
        </ol>
        <li><b>(Optional)</b> Enable GitHub OAuth2.</li>
        <ol type="i">
            <li>See the <a href="https://docs.github.com/en/developers/apps/building-oauth-apps/creating-an-oauth-app"><u>GitHub OAuth 2.0 API</u></a> page to create an application.</li>
            <li>Populate the <code>CYBERWARY_GITHUB_CLIENT_ID</code> and <code>CYBERWARY_GITHUB_SECRET</code> variables in your <code>.env</code> file.</li>
            <li>When requested, enter the callback URL as <code>{your_url_here}/portal/account/github/login/callback/</code>.</li>
        </ol>
        <li><b>(Optional)</b> Enable Microsoft OAuth2.</li>
        <ol type="i">
            <li>See the <a href="https://docs.microsoft.com/en-us/azure/active-directory/saas-apps/openidoauth-tutorial"><u>Microsoft OAuth</u></a> page to create an application</li>
            <li>Populate the <code>CYBERWARY_MICROSOFT_CLIENT_ID</code> and <code>CYBERWARY_MICROSOFT_SECRET</code> variables in your <code>.env</code> file (you may need to go through additional app verification to enable multi tenant users).</li>
            <li>When requested, enter the callback URL as <code>{your_url_here}/portal/account/microsoft/login/callback/</code>.</li>
        </ol>
    </ol>
</p>
<br>
<h2>Automated Data Import</h2>
<p>
    The CyberWary platform provides a script to automate the process of bulk importing and updating of common enumeration data that is cached in the database; data is imported directly from the data feeds made available by the National Vulnerability Database (NVD), maintained by the National Institute of Standards and Technology (NIST). 
</p>
<p>
    <b>Command Usage:</b> <code>python manage.py import_common_data --cpe --cwe --cpe --cve-year 2022</code>
</p>

| Option                | Description                                      |
|-----------------------|--------------------------------------------------|
| --cpe                 | Enables the import/update of all Common Platform Enumeration identifiers. |
| --cwe                 | Enables the import/update of all Common Weakness Enumeration identifiers. |
| --cve                 | Enables the import/update and matching of all identifiers for Common Vulnerabilities and Exposures . |
| --cve-year {year}     | Restricts the `--cve` import to only import/update CVEs from a single year. Range: `2002 - Current Year` |
<br>
<h2></h2>
<p>
    <img alt="University of Greenwich Logo" src="https://www.cyberwary.com/static/imgs/uog_black.png" width="260">
    <br>
    <b>School of Computing and Mathematical Sciences</b>
    <br>
    <i>Faculty of Liberal Arts and Sciences</i>
    <br><br>
    <b>Project Researcher</b>: William P
</p>
